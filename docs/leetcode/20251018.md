---
date: 2025-10-18
category:
  - LeetCode每日一题
tag:
  - 数组
  - 贪心
  - 排序
---

# [3397. 执行操作后不同元素的最大数量](https://leetcode.cn/problems/maximum-number-of-distinct-elements-after-operations/)

给你一个整数数组 `nums` 和一个整数 `k`。

你可以对数组中的每个元素 **最多** 执行 **一次** 以下操作：

- 将一个在范围 `[-k, k]` 内的整数加到该元素上。

返回执行这些操作后，`nums` 中可能拥有的不同元素的 **最大** 数量。

 

**示例 1：**

**输入：** nums = [1,2,2,3,3,4], k = 2

**输出：** 6

**解释：**

对前四个元素执行操作，`nums` 变为 `[-1, 0, 1, 2, 3, 4]`，可以获得 6 个不同的元素。

**示例 2：**

**输入：** nums = [4,4,4,4], k = 1

**输出：** 3

**解释：**

对 `nums[0]` 加 -1，以及对 `nums[1]` 加 1，`nums` 变为 `[3, 5, 4, 4]`，可以获得 3 个不同的元素。

 

**提示：**

- `1 <= nums.length <= 105`
- `1 <= nums[i] <= 109`
- `0 <= k <= 109`

# 解题思路

找一个新的位置，要尽可能的小，又要满足x-k，x+k的范围内。用pre记录前一个处理成功的位置

优化：如果数组长度小于最大能容纳的元素个数2k+1，直接返回答案。

```
class Solution {
public:
    int maxDistinctElements(vector<int>& nums, int k) {
        int n=nums.size();
        if(k*2+1>=n){
            return n;
        }
        sort(nums.begin(),nums.end());
        int ans=0;
        int pre=INT_MIN;
        for(int x:nums){
            x=min(max(x-k,pre+1),x+k);
            if(x>pre){
                ans++;
                pre=x;
            }
        }
        return ans;
    }
};
```

复杂度分析


- 时间复杂度：O(nlogn)
- 空间复杂度：O(1)
